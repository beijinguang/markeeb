---
title: Java性能调优工具
date: 2020-05-28 20:10:32
categories: [性能调优]
tags: [性能调优]
---
# Java性能调优工具



## Linux命令行工具

### top命令

#### 语法

```
top [-] [d delay] [q] [c] [S] [s] [i] [n] [b]
```

![image-20200901095826286](https://gitee.com/idea4j/imagerep/raw/master/images/image-20200901095826286.png)



两大区域**统计信息区**和**进程信息区**

#### 统计信息区

- 第一行：任务队列信息，与`uptime`命令执行结果相同。

  - 09:58:07：系统当前时间
  - up 195 days, 23:28：主机已运行时间
  - 5 users：用户连接数（不是用户数，who命令）
  - load average: 0.03, 0.09, 0.12：系统平均负载，统计最近1,5,15分钟的系统平均负载

  **补充**：`uptime -V`可查询版本

- 第二行：进程信息

  - Tasks: 128 total：进程总数
  - 1 running：正在运行的进程数
  - 127 sleeping：睡眠的进程数
  - 0 stopped：停止的进程数
  - 0 zombie：僵尸进程数

- 第三行：CPU信息（当有多个CPU时，这些内容可能会超过两行）

  - 2.8us：用户空间所占CPU百分比
  - 1.0sy：内核空间占用CPU百分比
  - 0.0 ni：用户进程空间内改变过优先级的进程占用CPU百分比
  - 96.3id：空闲CPU百分比
  - 0.0 wa：等待输入输出的CPU时间百分比
  - 0.0 hi：硬件CPU中断占用百分比
  - 0.0 si：软中断占用百分比
  - 0.0 st：虚拟机占用百分比

- 第四行：内存信息（与第五行的信息类似与free命令）

  - 8010424 total：物理内存总量
  - 6038816 used：已使用的内存总量
  - 274220 free：空闲的内存总量（free+used=total）
  - 1723692 buffers：用作内核缓存的内存量

- 第五行：swap信息

  - 0total：交换分区总量
  - 0used：已使用的交换分区总量
  - 0free：空闲交换区总量
  - 1663496cached Mem：缓冲的交换区总量，内存中的内容被换出到交换区，然后又被换入到内存，但是使用过的交换区没有被覆盖，交换区的这些内容已存在于内存中的交换区的大小，相应的内存再次被换出时可不必再对交换区写入。



#### 进程信息区

- PID:进程id
- PPID:父进程id
- RUSER:Real user name（看了好多，都是这样写，也不知道和user有什么区别，欢迎补充此处）
- UID:进程所有者的id
- USER:进程所有者的用户名
- GROUP:进程所有者的组名
- TTY:启动进程的终端名。不是从终端启动的进程则显示为?
- PR:优先级
- NI:nice值。负值表示高优先级，正值表示低优先级
- P:最后使用的CPU，仅在多CPU环境下有意义
- %CPU:上次更新到现在的CPU时间占用百分比
- TIME:进程使用的CPU时间总计，单位秒
- TIME+：进程所使用的CPU时间总计，单位1/100秒
- %MEM:进程使用的物理内存百分比
- VIRT:进程使用的虚拟内存总量，单位kb。VIRT=SWAP+RES
- SWAP:进程使用的虚拟内存中被被换出的大小
- RES:进程使用的、未被换出的物理内存的大小
- CODE:可执行代码占用的物理内存大小
- DATA:可执行代码以外的部分（数据段+栈）占用的物理内存大小
- SHR:共享内存大小
- nFLT:页面错误次数
- nDRT:最后一次写入到现在，被修改过的页面数
- S:进程状态（D=不可中断的睡眠状态，R=运行，S=睡眠，T=跟踪/停止，Z=僵尸进程）
- COMMAND:命令名/行
- WCHAN:若该进程在睡眠，则显示睡眠中的系统函数名
- Flags:任务标志



### top命令的使用

#### top使用格式

top [-] [d] [p] [q] [c] [C] [S] [s] [n]

#### top参数说明

- d: 指定每两次屏幕信息刷新之间的时间间隔。当然用户可以使用s交互命令来改变之。
- p: 通过指定监控进程ID来仅仅监控某个进程的状态。
- q: 该选项将使top没有任何延迟的进行刷新。如果调用程序有超级用户权限，那么top将以尽可能高的优先级运行。
- S: 指定累计模式
- s: 使top命令在安全模式中运行。这将去除交互命令所带来的潜在危险。
- i: 使top不显示任何闲置或者僵死进程。
- c: 显示整个命令行而不只是显示命令名

#### 交互命令

- Ctrl+L: 擦除并且重写屏幕。
- h或者?: 显示帮助画面，给出一些简短的命令总结说明。
- k: 终止一个进程。系统将提示用户输入需要终止的进程PID，以及需要发送给该进程什么样的信号。一般的终止进程可以使用15信号;如果不能正常结束那就使用信号9强制结束该进程。默认值是信号15。在安全模式中此命令被屏蔽。
- i: 忽略闲置和僵死进程。这是一个开关式命令。
- q: 退出程序。
- r: 重新安排一个进程的优先级别。系统提示用户输入需要改变的进程PID以及需要设置的进程优先级值。输入一个正值将使优先级降低，反之则可以使该进程拥有更高的优先权。默认值是10。
- S: 切换到累计模式。
- s: 改变两次刷新之间的延迟时间。系统将提示用户输入新的时间，单位为s。如果有小数，就换算成m s。输入0值则系统将不断刷新，默认值是5 s。需要注意的是如果设置太小的时间，很可能会引起不断刷新，从而根本来不及看清显示的情况，而且系统负载也会大大增加。
- f或者F: 从当前显示中添加或者删除项目。
- o或者O: 改变显示项目的顺序。
- l: 切换显示平均负载和启动时间信息。
- m: 切换显示内存信息。
- t: 切换显示进程和CPU状态信息。
- c: 切换显示命令名称和完整命令行。
- M: 根据驻留内存大小进行排序。
- P: 根据CPU使用百分比大小进行排序。
- T: 根据时间/累计时间进行排序。
- W: 将当前设置写入~/.toprc文件中。这是写top配置文件的推荐方法。





### sar命令

### vmstat

### iostat

### pidstat

